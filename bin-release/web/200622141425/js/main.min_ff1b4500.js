var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},__awaiter=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,s){function c(t){try{o(i.next(t))}catch(e){s(e)}}function h(t){try{o(i["throw"](t))}catch(e){s(e)}}function o(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(c,h)}o((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function r(t){return function(e){return i([t,e])}}function i(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(c=s[2&r[0]?"return":r[0]?"throw":"next"])&&!(c=c.call(s,r[1])).done)return c;switch(s=0,c&&(r=[0,c.value]),r[0]){case 0:case 1:c=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,s=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(c=o.trys,!(c=c.length>0&&c[c.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!c||r[1]>c[0]&&r[1]<c[3])){o.label=r[1];break}if(6===r[0]&&o.label<c[1]){o.label=c[1],c=r;break}if(c&&o.label<c[2]){o.label=c[2],o.ops.push(r);break}c[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(i){r=[6,i],s=0}finally{n=c=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n,s,c,h,o={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return h={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,r){function i(i){e.call(r,i,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?i(n):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DrawRect=function(t){function e(e,r){var i=t.call(this)||this;i.rectArr=[],i.cont=0,i.cont=e;for(var n=0;e>n;n++){var s=new egret.Shape;s.graphics.lineStyle(5,0),s.graphics.beginFill(16711680,1),s.graphics.drawRect(r,540-30*n,300-60*n,30),s.graphics.endFill(),i.addChild(s),i.rectArr.push(s),s.anchorOffsetX=.5*s.width,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,i.begin,i)}return i}return __extends(e,t),e.prototype.begin=function(t){this.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},e.prototype.update=function(){for(var t=0;t<this.cont;t++)this.rectArr[0].y-=10,egret.log(this.rectArr[t].y)},e}(eui.Component);__reflect(DrawRect.prototype,"DrawRect");var Game=function(t){function e(){var e=t.call(this)||this;return e.rectFirArr=[],e.rectSecArr=[],e.rectThiArr=[],e.isMove=!1,e.posY=100,e.timer=0,e.steps=0,e.time=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.initData,e),e}return __extends(e,t),e.prototype.initData=function(){this.skinName="game",this.stepsLabel.text="步数:"+this.steps,this.timeLabel.text="时间:"+this.timer+"秒",this.drawRect(4),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},e.prototype.begin=function(t){if(0==this.isMove){var e=0;if(t.target.x==this.first.x&&this.rectFirArr.length>0){this.currentRect=this.rectFirArr[0];for(var r=1;r<this.rectFirArr.length;r++)this.currentRect.width>this.rectFirArr[r].width&&(this.currentRect=this.rectFirArr[r]);e=this.currentRect.y-this.posY,egret.Tween.get(this.currentRect).to({y:this.posY},e).wait(60),this.isMove=!0;for(var r=0;r<this.rectFirArr.length;r++)this.currentRect==this.rectFirArr[r]&&this.rectFirArr.splice(r,1);return}if(t.target.x==this.second.x&&this.rectSecArr.length>0){this.currentRect=this.rectSecArr[0];for(var r=1;r<this.rectSecArr.length;r++)this.currentRect.width>this.rectSecArr[r].width&&(this.currentRect=this.rectSecArr[r]);e=this.currentRect.y-this.posY,egret.Tween.get(this.currentRect).to({y:this.posY},e).wait(60),this.isMove=!0;for(var r=0;r<this.rectSecArr.length;r++)this.currentRect==this.rectSecArr[r]&&this.rectSecArr.splice(r,1);return}if(t.target.x==this.third.x&&this.rectThiArr.length>0){this.currentRect=this.rectThiArr[0];for(var r=1;r<this.rectThiArr.length;r++)this.currentRect.width>this.rectThiArr[r].width&&(this.currentRect=this.rectThiArr[r]);e=this.currentRect.y-this.posY,egret.Tween.get(this.currentRect).to({y:this.posY},e).wait(60),this.isMove=!0;for(var r=0;r<this.rectThiArr.length;r++)this.currentRect==this.rectThiArr[r]&&this.rectThiArr.splice(r,1);return}}var i=0,n=!1;if(1==this.isMove){var s=0;if(s=Math.abs(this.currentRect.x-(t.target.x+180)),t.target.x==this.first.x){if(this.rectFirArr.length>0){for(var c=this.rectFirArr[0],r=1;r<this.rectFirArr.length;r++)c.width>this.rectFirArr[r].width&&(c=this.rectFirArr[r]);n=this.currentRect.width<c.width?!0:!1}else n=!0;n&&(i=540-30*this.rectFirArr.length,egret.Tween.get(this.currentRect).to({x:t.target.x+180},s).to({y:i},i),this.rectFirArr.push(this.currentRect),this.currentRect=null,this.isMove=!1,n=!1,this.steps+=1,this.stepsLabel.text="步数:"+this.steps)}if(t.target.x==this.second.x){if(this.rectSecArr.length>0){for(var c=this.rectSecArr[0],r=1;r<this.rectSecArr.length;r++)c.width>this.rectSecArr[r].width&&(c=this.rectSecArr[r]);n=this.currentRect.width<c.width?!0:!1}else n=!0;n&&(i=540-30*this.rectSecArr.length,egret.Tween.get(this.currentRect).to({x:t.target.x+180},s).to({y:i},i),this.rectSecArr.push(this.currentRect),this.currentRect=null,this.isMove=!1,n=!1,this.steps+=1,this.stepsLabel.text="步数:"+this.steps)}if(t.target.x==this.third.x){if(this.rectThiArr.length>0){for(var c=this.rectThiArr[0],r=1;r<this.rectThiArr.length;r++)c.width>this.rectThiArr[r].width&&(c=this.rectThiArr[r]);n=this.currentRect.width<c.width?!0:!1}else n=!0;n&&(i=540-30*this.rectThiArr.length,egret.Tween.get(this.currentRect).to({x:t.target.x+180},s).to({y:i},i),this.rectThiArr.push(this.currentRect),this.currentRect=null,this.isMove=!1,this.steps+=1,this.stepsLabel.text="步数:"+this.steps)}}},e.prototype.update=function(){this.time++,this.time%60==0&&(this.timer++,this.timeLabel.text="时间:"+this.timer+"秒")},e.prototype.drawRect=function(t){for(var e=0;t>e;e++){var r=new egret.Shape;r.graphics.lineStyle(5,0),r.graphics.beginFill(16711680,1),r.graphics.drawRect(0,0,300-60*e,30),r.graphics.endFill(),this.addChild(r),r.anchorOffsetX=.5*r.width,this.rectFirArr.push(r),this.rectFirArr[e].x=230,this.rectFirArr[e].y=540-30*e,this.rectFirArr[e].width=300-60*e}this.currentRect=this.rectFirArr[0];for(var e=1;e<this.rectFirArr.length;e++)this.currentRect.width>this.rectFirArr[e].width&&(this.currentRect=this.rectFirArr[e])},e}(eui.Component);__reflect(Game.prototype,"Game");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return r.sent(),[4,this.loadTheme()];case 2:return r.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return r.sent(),this.stage.removeChild(t),[3,5];case 4:return e=r.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,r){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=new Game;this.addChild(t)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,r,i){function n(t){e.call(i,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),r.call(i))}var c=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,r){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},c)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var h=t.split("/");h.pop();var o=h.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(o,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){e.call(i,generateJSON.paths[t])},c)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);